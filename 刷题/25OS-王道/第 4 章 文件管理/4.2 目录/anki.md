---
TARGET DECK: 刷题::25OS-王道::第 4 章 文件管理::4.2 目录::anki
---
## 目录管理的基本概念
Q:什么是文件目录？
A:文件目录是一种用于组织和定位文件的数据结构。
补充细节：文件目录就像一个索引，它记录了文件系统的组织结构，方便用户快速找到需要的文件。

Q:文件目录管理有哪些基本要求？
A:文件目录管理需要实现“按名存取”；提高对目录的检索速度；提供用于控制访问文件的信息；允许不同用户对不同文件采用相同的名字。
补充细节：这些要求是为了保证文件系统易用、高效、安全。

## 目录结构

### 单级目录结构

Q:什么是单级目录结构？
A:在整个文件系统中只建立一张目录表，每个文件占一个目录项。
补充细节：就像一个房间，所有东西都放在同一个地方，简单但容易混乱。

Q:单级目录结构有什么缺点？
A:查找速度慢、文件不允许重名、不便于文件共享，不适用于多用户系统。
补充细节：想象一下，在一个房间里找一件东西，你需要翻遍所有东西才能找到，而且不能放相同的东西，也不方便大家一起用。

### 两级目录结构

Q:什么是两级目录结构？
A:将文件目录分成主文件目录 (MFD) 和用户文件目录 (UFD) 两级。
补充细节：就像在一个大仓库里，先找到每个人的仓库，再在他们的仓库里找东西，例如图中所示的主文件目录和用户文件目录。
![两级目录结构](https://img.hwenyi.tech/202407291547087.webp)

Q:两级目录结构有什么优点？
A:提高了检索的速度，解决了多用户之间的文件重名问题，文件系统可以在目录上实现访问限制。
补充细节：这样找东西更快了，每个人都可以有相同名字的东西，还可以控制谁可以看谁的东西。例如图中User1和User3都有文件名为A的文件。
![两级目录结构](https://img.hwenyi.tech/202407291547087.webp)

Q:两级目录结构有什么缺点？
A:缺乏灵活性，不能对文件分类。
补充细节：每个人的仓库只能放一种类型的物品，不能分类存放。

### 树形目录结构

Q:什么是树形目录结构？
A:将两级目录结构加以推广，就形成了树形目录结构。
补充细节：就像一个树状的文件夹，每个文件夹可以包含多个子文件夹，例如Linux操作系统的文件目录。
![树形目录结构](https://img.hwenyi.tech/202407291547088.webp)

Q:树形目录结构有什么优点？
A:可以很方便地对文件进行分类，层次结构清晰，也能够更有效地进行文件的管理和保护。
补充细节：就像一个图书馆，书籍按类别分类存放，方便查找和管理。例如Linux操作系统中，`/bin`存放的是系统命令，`/home`存放的是用户文件。
![树形目录结构](https://img.hwenyi.tech/202407291547088.webp)

Q:树形目录结构有什么缺点？
A:查找一个文件，需要按路径名逐级访问中间节点，增加了磁盘访问次数，影响查询速度。
补充细节：就像从树根到树叶要经过很多分支，需要走很多路才能找到目标。

Q:文件路径有哪两种表示方式？它们的区别是什么？
A:绝对路径和相对路径。绝对路径从根目录开始，相对路径从当前目录开始。
补充细节：绝对路径就像从图书馆的大门开始，一直走到你要找的书架；相对路径就像你站在图书馆的某个书架前，只需找到你想要的那本书的书架位置。例如在Linux系统中，`/dev/hda`是绝对路径，`./ls`是相对路径。

Q:设置当前工作目录有什么作用？(2010)
A:设置当前工作目录可以简化文件路径的表示，提高文件访问效率。
补充细节：就像你在图书馆的某个区域找书，你就可以把这个区域设置为你的当前目录，这样你就不需要每次都从图书馆大门开始找了。

### 无环图目录结构

Q:什么是无环图目录结构？
A:在树形目录结构的基础上增加一些指向同一节点的有向边，使整个目录成为一个有向无环图。
补充细节：就像一个树状的文件夹，但一些文件夹可以同时出现在多个位置，方便共享，例如图中所示的`mail`文件。
![无环图目录结构](https://img.hwenyi.tech/202407291547089.webp)

Q:无环图目录结构有什么优点？
A:方便地实现了文件的共享，同一个文件或子目录可以出现在两个或多个目录中。
补充细节：就像一个文件可以同时放在多个人的仓库里，方便大家一起使用。例如图中所示的`mail`文件。
![无环图目录结构](https://img.hwenyi.tech/202407291547089.webp)

Q:无环图目录结构有什么缺点？
A:使得系统的管理变得更加复杂。
补充细节：就像管理一个共享的仓库，需要更加小心，防止出现混乱。因为需要维护指向同一文件的多个指针，以及处理文件删除时的共享计数问题。

## 目录的操作

Q:目录有哪些基本操作？
A:搜索、创建文件、删除文件、创建目录、删除目录、移动目录、显示目录、修改目录。
补充细节：这些操作就像对文件夹进行管理，例如新建文件夹、删除文件夹、移动文件等。

Q:删除目录有哪两种方式？
A:①不删除非空目录，删除时要先删除目录中的所有文件，并递归地删除子目录。②可删除非空目录，目录中的文件和子目录同时被删除。
补充细节：就像删除一个文件夹，可以选择先删除里面的东西，再删除文件夹，也可以直接删除整个文件夹。

## 目录实现

Q:目录实现有哪些基本方法？
A:线性列表和哈希表。
补充细节：就像用不同的方法来存放和查找文件，线性列表就像一个清单，哈希表就像一个字典。

### 线性列表

Q:线性列表实现目录有什么优缺点？
A:优点是实现简单，缺点是查找比较费时。
补充细节：就像用一个清单来记录所有文件，简单易懂，但找东西时要逐个查找。例如，单级目录结构就是采用线性列表实现的。
![单级目录结构](https://img.hwenyi.tech/202407291547086.webp)

### 哈希表

Q:哈希表实现目录有什么优缺点？
A:优点是查找非常迅速，插入和删除也较简单，缺点是需要一些措施来避免冲突。
补充细节：就像用一个字典来记录所有文件，查找速度快，但可能会出现两个文件有相同的键值的情况。

## 文件共享

Q:什么是文件共享？
A:文件共享使多个用户共享同一个文件，系统中只需保留该文件的一个副本，避免存储空间浪费。
补充细节：就像几个人共同使用一个文件，每个人都可以访问和修改它，不用每个人都保存一份。

### 基于索引节点的共享方式 (硬链接)

Q:什么是硬链接？(2017)
A:硬链接是基于索引节点的共享方式，它将文件的物理地址和属性等信息放在索引节点中，在文件目录中只设置文件名及指向相应索引节点的指针。
补充细节：就像一个文件有多个标签，每个标签指向同一个文件。例如，用户A和用户B共享文件`Test`。
![硬链接](https://img.hwenyi.tech/202407291547091.webp)

Q:硬链接是如何实现文件共享的？
A:每个索引节点中有一个链接计数 count，表示链接到本索引节点 (即文件) 上的用户目录项的数目。
当 count > 1 时，表示有多个用户目录项链接到本文件上，即有多个用户共享此文件。
补充细节：当一个文件有多个标签时，只要有一个标签存在，这个文件就不会被删除。例如，当用户B链接到文件`Test`上时，`count=2`，即使用户A删除了文件，用户B仍然可以访问。
![文件共享中的链接计数](https://img.hwenyi.tech/202407291547092.webp)

### 利用符号链实现文件共享 (软链接)

Q:什么是软链接？
A:软链接也称为符号链接，它类似于Windows系统中的快捷方式。为使用户B能共享用户A的一个文件F，可由系统创建一个LINK类型的新文件L，并将文件L写入用户B的目录，以实现B的目录与文件F的链接。文件L中只含有被链接文件F的路径名。
补充细节：就像一个文件有一个快捷方式，它指向另一个文件。例如，用户B通过文件L访问用户A的文件F。
![软链接](https://img.hwenyi.tech/202407291547093.webp)

Q:软链接方式删除共享文件后会发生什么情况？(2021)
A:当文件主将一个共享文件删除后，若其他用户又试图通过符号链去访问它时，则会访问失败。
补充细节：就像删除了原文件，快捷方式就失效了。

Q:软链接和硬链接有什么区别？
A:硬链接就是多个指针指向一个索引节点，软链接就是将到达共享文件的路径保存下来，硬链接的查找速度要比软链接的快。
补充细节：硬链接就像多个标签指向同一个文件，软链接就像一个指向文件的地址。

## 文件控制块(FCB)

Q:什么是文件控制块(FCB)？
A:文件控制块(FCB)是文件目录中最重要的数据结构，它包含了文件的各种属性信息，例如文件名、文件类型、文件大小、创建时间、修改时间、访问权限等等。
补充细节：FCB 就像文件的身份证，记录了文件的全部信息。操作系统通过FCB来管理和控制文件。

Q:文件控制块(FCB)有哪些作用？
A:FCB的作用包括：
- 实现文件的按名存取。
- 控制文件的访问权限。
- 记录文件的物理地址。
- 提供文件的各种属性信息。
补充细节：FCB是文件管理系统的核心数据结构，它为文件的管理和操作提供了必要的信息。

## 文件的逻辑结构和物理结构

Q:什么是文件的逻辑结构？
A:文件的逻辑结构是指用户看到的文件组织形式，它是用户可以直接访问的数据结构。
补充细节：常见的逻辑结构有：
- 顺序结构：文件中的记录按顺序排列。
- 索引结构：文件中的记录可以随机访问。
- 记录式结构：文件由若干个记录组成，每个记录有自己的标识符。

Q:什么是文件的物理结构？
A:文件的物理结构是指文件在外存上的存储方式。
补充细节：常见的物理结构有：
- 连续结构：文件的数据块连续存放。
- 链接结构：文件的数据块通过指针链接起来。
- 索引结构：文件的数据块地址存放在索引表中。

## 文件系统的性能指标

Q:文件系统的性能指标有哪些？
A:文件系统的性能指标主要包括：
- 空间利用率：外存空间的使用效率。
- 访问速度：读取和写入文件的快慢。
- 可靠性：数据的一致性和安全性。
- 安全性：防止未经授权的访问和修改。

## 文件系统的安全性

Q:文件系统如何保证安全性？
A:文件系统通过以下机制来保证安全性：
- 访问控制：限制用户对文件的访问权限。
- 数据加密：对文件进行加密，防止未经授权的访问。
- 备份和恢复：定期备份文件，以便在数据丢失时进行恢复。
- 审计：记录用户的操作，以便追踪安全事件。

Q: 在一个树形目录结构的文件系统中，用户A希望共享自己的文件file1给用户B，同时希望用户B只能读取文件file1而不能修改它，请问应该如何实现？
A: 可以通过以下两种方式实现：
1. **访问控制列表(ACL)：** 在文件file1的ACL中添加用户B，并设置用户B的访问权限为只读。
2. **创建符号链接：** 为文件file1创建一个符号链接file2，并将file2放置在用户B的目录下。然后，修改文件file1的访问权限，使其对用户B只读。
补充细节：第一种方法更加灵活，可以针对不同的用户设置不同的访问权限；第二种方法更加简单，但用户B只能通过符号链接访问文件file1。

