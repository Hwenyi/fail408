## 题11
### 题目
2016 【统考真题】某个进程调度程序采用基于优先数 (priority) 的调度策略, 即选择**优先数最小**的进程运行, 进程创建时由用户指定一个 **nice** 作为静态**优先**数。
为了动态调整优先数, 引入运行时间 **cpuTime** 和等待时间 **waitTime**, 初值均为 0 。
进程处于执行态时, cpuTime 定时**加 1**, 且 waitTime **置 0** ; 
进程处于就绪态时, cpuTime **置 0** , waitTime 定时**加 1** 。
请回答下列问题:
1. 若调度程序只将 nice 的值作为进程的优先数,即 priority $=$ nice,则可能会出现饥饿现象。为什么?
2. 使用 nice, cpuTime 和 waitTime 设计一种动态优先数计算方法, 以避免产生饥饿现象, 并说明 waitTime 的作用。
### 分析
1. nice越小，越被调度，这个nice被运行时间和等待时间调节，但是在第一问这个情景下，应该是没有引入这两个参数来做调节，是一个静态的、直接分配的nice，直接决定了调度
如果是站在这个角度上看，那么如果每次新进来的nice值都比较小，那么那些nice值大的，就会一直等待，就会出现饥饿现象
2. 第二问我们应该用多级反馈[[调度算法]]的思路来设计
- 首先进来的时候，给一个nice值，nice值传两个参数，一个是完成这个任务，需要多少时间的cpu时间，一个是等待时间，初值都是0
- 然后根据nice值，进程被定好了优先级开始接收cpu运行，执行ctime就加1，然后优先级更高的进程进来了，当前的进程就退出
	- 如果一直没有nice值更高的，或者说，当前进程是一个非常吃cpu的任务，一直占用，ctime累计到一定的值，应该重新计算nice值，降低他的调度优先级，让别的进程上来
- 每个被调度的进程，如果占用cpu时间超过一定的界限，比如说10个时间片，那么就把这个进程的nice值应该重新计算，然后降低优先级，让其他等待的进程调度上来
- 等待时间的作用就是，防止有的进程等待太久，
	- 这个等待有可能是，有的任务吃cpu，一直占用cpu造成的
	- 还有可能是因为一些其他异步问题导致的，如果是前者，ctime可以调节到，如果是自己的问题，那么wait time应该主要承担这个调节作用
	- 如果他的waittime累计太大了，就应该被重新计算nice值，然后考虑提高优先级，防止饥饿
### 解
需要直接把这种计算方式写出来，不能直接只是分析，显然只要给两个参数一个正的权值来做调节应该就可以了
1. 由于采用了静态优先数, 当就绪队列中总有优先数较小的进程时, 优先数较大的进程一直没有机会运行, 因而会出现饥饿现象。
2. 一种动态优先数计算方法为 `priority = nice + k1 * cpuTime - k2 * waitTime`，其中 `k1 > 0, k2 > 0`，分别用来调整 `cpuTime` 和 `waitTime` 在 `priority` 中所占的比例。若一个进程的运行时间较长, 则其 `cpuTime` 就增加, 进而降低其优先级; 若一个进程的等待时间较长, 则其 `waitTime` 增加, 进而会提高其优先级。于是, `waitTime` 就可使长时间等待的进程优先数减少, 进而避免出现饥饿现象。