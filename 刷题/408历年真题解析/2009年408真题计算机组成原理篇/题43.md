---
publish: true
tags: 
aliases: 
finished: true
title: 题43
created: "2024-11-21 06:38"
updated: "2024-11-21 07:40"
---
## 题43
### 题目
> [!question]+
> （8 分）
> 
> 某计算机的 CPU 主频为 500MHz，CPI 为 5（即执行每条指令平均需 5 个时钟周期）。假定某外设的数据传输率为 0.5MB/s，采用中断方式与主机进行数据传送，以 32 位为传输单位，对应的中断服务程序包含 18 条指令，中断服务的其他开销相当于 2 条指令的执行时间。请回答下列问题，要求给出计算过程。
> 
> (1) 在中断方式下，CPU 用于该外设 I/O 的时间占整个 CPU 时间的百分比是多少？
> 
> (2) 当该外设的数据传输率达到 5MB/s 时，改用 DMA 方式传送数据。假定每次 DMA 传送块大小为 5000B，且 DMA 预处理和后处理的总开销为 500 个时钟周期，则 CPU 用于该外设 I/O 的时间占整个 CPU 时间的百分比是多少（假设 DMA 与 CPU 之间没有访存冲突）？
> 
### 解
> [!done]+
> 
> 首先统一单位，
> 
> (1) **方法一：通过频率计算**
> 
> CPI 为 5，在中断方式下，传输一个传输单位对应的中断服务程序包含 18 条指令，中断服务的其他开销相当于 2 条指令的执行时间。传输一个传输单位的时钟周期数 = 中断服务程序的时钟周期数 + 中断服务的其他开销的时钟周期数 = 5×18+5×2 = 100。
> 
> 一个传输单位 32bit=4B，为达到外设 0.5MB/s 的数据传输率，外设每秒申请的中断次数：0.5 MB/4B = 125000。需要的时钟周期数为 125000×100=12.5M。
> 
> CPU 主频为 500MHz，占比为 12.5M/500M = 2.5%。
> 
> **方法二：通过时间计算**
> 
> CPU 主频为 500MHz，时钟周期为 1/500MHz = 2ns，CPI 为 5，一条指令执行时间为 2ns×5=10ns，在中断方式下，传输一个传输单位对应的中断服务程序包含 18 条指令，中断服务的其他开销相当于 2 条指令的执行时间。即传输一个传输单位的 CPU 时间为 (18+2)×10ns = 200ns。
> 
> 一个传输单位 32bit=4B，数据传输率为 0.5MB/s，传输一个传输单位的 I/O 时间为 4B/(0.5MB/s)=8μs。
> 
> CPU 用于该外设 I/O 的时间占整个 CPU 时间的百分比是 200ns/8μs = 2.5%。
> 
> (2) **方法一：通过频率计算**
> 
> 外设数据传输率提高到 5MB/s 时，每次 DMA 传送块大小为 5000B，每秒需要的 DMA 次数：5MB/5000B = 1000。
> 
> 每次 DMA 预处理预处理和后处理的总开销为 500 个时钟周期，得每秒 CPU 用于 DMA 需要的时钟周期数为：1000×500 = 500000 = 0.5M。
> 
> CPU 用于外设 I/O（即用于 DMA）的时间占整个 CPU 时间的百分比：0.5M/500M = 0.1%。
> 
> **方法二：通过时间计算**
> 
> 每次 DMA 传送块大小为 5000B，外设数据传输率提高到 5MB/s 时，每次 DMA 传送的 I/O 时间是 5000B/(5MB/s)=1ms。
> 
> CPU 主频为 500MHz，时钟周期为 1/500MHz=2ns，每次 DMA 预处理预处理和后处理的总开销为 500 个时钟周期，每次 DMA 传送的 CPU 时间为 500×2ns=1μs。
> 
> CPU 用于该外设 I/O 的时间占整个 CPU 时间的百分比是 1μs/1ms=0.1%。
> 
> 0.1%<2.5%，满足 DMA 方式比中断方式更加高效假设，通过这样的比较可以粗略检查计算结果是否正确。