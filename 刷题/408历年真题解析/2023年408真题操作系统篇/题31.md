---
publish: true
tags: 
aliases: 
finished: true
title: 题31
created: "2024-11-21 07:29"
updated: "2024-11-21 07:40"
---
## 题31
### 题目
> [!question]+
> 若文件 F 仅被进程 P 打开并访问，则当进程 P 关闭 F 时，下列操作中，文件系统需要完成的是（ ）。
> 
> A. 删除目录中文件 F 的目录项
> 
> B. 释放 F 的索引节点所占的内存空间
> 
> C. 释放 F 的索引节点所占的外存空间
> 
> D. 将文件磁盘索引节点中的链接计数减 1
### 解
> [!done]+
> 索引节点是文件系统中用来记录文件的元数据的数据结构，包括索引节点编号、文件大小、访问权限、修改日期、数据的位置等。索引节点和文件一一对应，它跟文件内容一样会被持久化到磁盘，所以，索引节点同样占磁盘。
> 
> 链接计数是文件系统用于统计一个文件被引用的次数，每当有一个进程打开该文件时，链接计数就会加 1。当进程关闭文件时，文件系统会相应地将链接计数减 1。当链接计数减到 0 时，表示没有任何进程打开该文件了，文件系统可以将其相关的资源进行释放。
> 
> A 错误。进程 P 可以通过目录中文件 F 的目录项再次访问文件 F，暂时不能删除。
> 
> B 正确。由于初始时文件 F 仅被进程 P 打开并访问，索引节点中的链接计数为 1。当进程 P 关闭文件 F 时，文件系统需要完成的操作是将文件内存索引节点中的链接计数减 1，此时索引节点中的链接计数减 1 后为 0，表示没有任何进程打开该文件了，文件系统可以将其相关的资源进行释放，包括文件 F 的索引节点所占的内存空间，文件 F 的所占的内存空间。
> 
> C 错误。题目要求关闭文件 F，没有要求删除文件 F。只有执行删除文件 F，文件磁盘索引节点中的链接计数减 1，当磁盘索引节点引用计数为 0 的时候，会释放 F 的索引节点所占的外存空间，如果该索引节点为硬链接的索引节点，那么还需要释放文件 F 指向的文件实体所占的外存空间。当释放 F 的索引节点所占的外存空间后，该索引节点不复存在，也就无法在外存中通过该索引节点访问文件 F。
> 
> D 错误。题目要求关闭文件 F，没有要求删除文件 F，磁盘索引节点计数中的链接计数不受影响。
> 
> 本题选 B。