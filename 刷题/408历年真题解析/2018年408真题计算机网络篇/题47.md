---
publish: true
tags: 
aliases: 
finished: true
title: 题47
created: "2024-11-21 07:18"
updated: "2024-11-21 07:40"
---
## 题47
### 题目
> [!question]+
> （7 分）
> 
> 某公司网络如题 47 图所示。IP 地址空间 192.168.1.0/24 被均分给销售部和技术部两个子网，并已分别为部分主机和路由器接口分配了 IP 地址，销售部子网的 MTU=1500 B，技术部子网的 MTU=800 B。
> 
> ![](https://pica.zhimg.com/v2-ecb69f33c2e6d6821d4ccaf8af68aa24_r.jpg)
> 
> 请回答下列问题。
> 
> (1) 销售部子网的广播地址是什么？技术部子网的子网地址是什么？若每个主机仅分配一个 IP 地址，则技术部子网还可以连接多少台主机？
> 
> (2) 假设主机 192.168.1.1 向主机 192.168.1.208 发送一个总长度为 1500 B 的 IP 分组，IP 分组的头部长度为 20 B，路由器在通过接口 F1 转发该 IP 分组时进行了分配。若分片时尽可能分为最大片，则一个最大 IP 分片封装数据的字节数是多少？至少需要分为几个分片？每个分片的片偏移量是多少？
### 解
> [!done]+
> (1) IP 地址空间 192.168.1.0/24 被均分给销售部和技术部两个子网，将 192.168.1.0/24 后 32-24=8 位写成二进制形式，其中主机号的位用 x 表示，每个 x 可以取 0 或 1。二进制位用红色表示。得到 $\rm 192.168.1.\color{red}{xxxxxxxx}$ ，因为要均匀划分给两个子网，取出其中 $\lceil \log_22\rceil=1$ 位作为子网号，得到两个子网：
> 
> $\rm 192.168.1.\color{red}{0xxxxxxx}$
> 
> $\rm 192.168.1.\color{red}{1xxxxxxx}$
> 
> 对于 $\rm 192.168.1.\color{red}{0xxxxxxx}$ ，即 192.168.1.0/25，
> 
> 将其主机号位全取 0，得到其网络地址：192.168.1.0
> 
> 将其主机号位全取 1，得到其广播地址：192.168.1.127
> 
> 其余为其可分配的主机号，192.168.1.1~192.168.1.126
> 
> 对于 $\rm 192.168.1.\color{red}{1xxxxxxx}$ ，即 192.168.1.128/25，
> 
> 将其主机号位全取 0，得到其网络地址：192.168.1.128
> 
> 将其主机号位全取 1，得到其广播地址：192.168.1.255
> 
> 其余为其可分配的主机号，192.168.1.129~192.168.1.254
> 
> 观察销售部分配的地址为 192.168.1.1~192.168.1.20，属于 192.168.1.1~192.168.1.126，即其所在子网为 192.168.1.0/25。
> 
> 观察技术部分配的地址为 192.168.1.129~192.168.1.208，属于 192.168.1.129~192.168.1.254，即其所在子网为 192.168.1.128/25。
> 
> 第一问。销售部子网的广播地址即 192.168.1.0/25 的广播地址，为 192.168.1.127。
> 
> 第二问。技术部子网的子网地址即 192.168.1.128/25 的网络地址，为 192.168.1.128。
> 
> 第三问。技术部子网可分配的主机号为 192.168.1.129~192.168.1.254，共计 254-129+1=126 个。已经分配的主机号为 192.168.1.129~192.168.1.208 和路由器接口 F1 的地址 192.168.1.254，共计 208-129+1+1=81 个，因此还可以分配的主机号有 126-81=45，即若每个主机仅分配一个 IP 地址，则技术部子网还可以连接 45 台主机。
> 
> (2) 假设主机 192.168.1.1 向主机 192.168.1.208 发送一个总长度为 1500 B 的 IP 分组，IP 分组的头部长度为 20 B，路由器在通过接口 F1 转发该 IP 分组时进行了分配。若分片时尽可能分为最大片，则一个最大 IP 分片封装数据的字节数是多少？至少需要分为几个分片？每个分片的片偏移量是多少？
> 
> 主机 192.168.1.1 向主机 192.168.1.208 发送一个总长度为 1500 B 的 IP 分组，销售部子网的 MTU=1500 B，技术部子网的 MTU=800 B。因此，该 IP 分组能够顺利在销售部子网中进行传输，1500 B > 800 B，进入技术部子网时要进行分片。
> 
> 分片先去除原来的 IP 分组的头的 20 B，对数据载荷 1500 B - 20 B = 1480 B 进行分片，分片后每个分片的数据载荷不能超过 800 B -20 B = 780 B，且要求是 8 B 的整数倍（片偏移字段以 8 B 为单位）。
> 
> 第一问。最大 IP 分片封装数据的字节数为 $\lfloor 780\text{ B}/8\rfloor\times 8 = 776 \text{ B}$ 。
> 
> 第二问。至少需要分为 $\lceil 1480\text{ B}/776 \text{ B}\rceil=2$ 个分片。
> 
> 第三问。第一个分片的片偏移量是 0 B / 8 B = 0，第二个分片的片偏移量是 776 B / 8 B = 97。
> 
> 分片效果如下图所示：
> 
> ![](https://picx.zhimg.com/v2-072f277a86abff8477bb6bb59d720f15_r.jpg)