---
publish: true
tags: 
aliases: 
finished: true
title: 题19
created: "2024-11-21 07:37"
updated: "2024-11-21 07:40"
---
## 题19
### 题目
> [!question]+
> 在采用 “取指、译码 / 取数、执行、访存、写回” 5 段流水线的 RISC 处理器中，下列关于指令流水线数据冒险处理的叙述中，错误的是
> 
> A. 相邻两条指令中的操作数相关可能引起数据冒险
> 
> B. 在数据相关的指令间插入 “气泡” 能避免数据冒险
> 
> C. 所有数据冒险都可以通过加入转发（旁路）电路解决
> 
> D. 所有数据冒险都能通过调整指令顺序和插入 nop 指令解决
### 解
> [!done]+
> 以 2023 年题 19 为例。
> 
> 在采用 “取指、译码 / 取数、执行、访存、写回” 5 段流水线的 RISC 处理器中，执行如下指令序列（第一列为指令序号），其中 s0、s1、s2、s3 和 t2 表示寄存器编号。
> 
> ```cpp
> I1  add s2, s1, s0  // R[s2] ← R[s1] + R[s0]
> I2  load s3, 0(s2)  // R[s3] ← M[R[s2] + 0]
> I3  beq t2, s3, L1  // if R[t2] = R[s3] jump to L1
> I4  addi t2, t2, 20 // R[t2] ← R[t2] + 20
> I5 L1: …
> ```
> 
> 选项 A：若相邻两条指令前一条为对某寄存器的写操作，后一条为对该寄存器的读操作，后一条指令的译码 / 取数阶段会在前一条指令的写回阶段前执行，这样就产生了写后读数[[数据冒险]] (read after write Data Hazard, RAW Data Hazard)。读取某数据操作必须在写入该数据操作之后执行，否则可能产生错误。例如上例中 I2 和 I1 中的操作数 s2 存在数据冒险。因此选项 A 叙述正确。
> 
> 选项 B：插入 “气泡” 或 nop 指令是一种阻塞方法，用于延缓后续指令的执行，直到相关数据可用。这样可以避免[[数据冒险]]，确保指令正确执行。因此选项 B 叙述正确。
> 
> 选项 C：转发（旁路）技术可以在某些情况下解决[[数据冒险]]，它允许在数据写入寄存器之前就将数据传递给需要它的指令。然而，转发技术并不能解决所有类型的数据冒险，例如装入 - 使用数据冒险 (load-use Data Hazard)，即当一条 Load 指令的结果被紧随其后的指令使用时，即使有转发技术，仍然需要配合一次阻塞操作来确保数据的正确性。例如上例中 I3 和 I2 之间存在数据冒险**。**因此选项 C 叙述错误。
> 
> 若上例采用转发（旁路）技术，插入 nop 指令进行阻塞，指令的执行过程如下图所示。
> 
> ![](https://pic1.zhimg.com/v2-772bb3c62dc21ddfd9ac1c48f7e29880_r.jpg)
> 
> 选项 D：理论上只要插入足够的 nop 指令进行延缓后续指令的执行，就能保证所有指令顺序执行，但这样做会导致性能下降，配合调整指令顺序可以优化性能。所以理论上所有数据冒险都能通过调整指令顺序和插入 nop 指令解决。因此选项 D 叙述正确。
> 
> 若上例不采用转发（旁路）技术，插入 nop 指令进行阻塞，指令的执行过程如下图所示。
> 
> ![](https://pica.zhimg.com/v2-820fee63688978aad4d97833b6a6b950_r.jpg)
> 
> 本题要求选择叙述错误的选项。
> 
> 本题选 C。