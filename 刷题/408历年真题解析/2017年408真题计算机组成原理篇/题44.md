---
publish: true
tags: 
aliases: 
finished: true
title: 题44
created: "2024-11-21 07:17"
updated: "2024-11-21 07:40"
---
## 题44
### 题目
> [!question]+
> （10 分）
> 
> 在按字节编址的计算机 M 上，题 43 中 f1 的部分源程序（阴影部分）与对应的机器级代码（包括指令的虚拟地址）如下图所示。
> 
> ```cpp
> int f1(unsigned n)
> 1   00401020 55         push ebp
>     ...      ...        ...
>         for (unsigned i = 0; i <= n-1; i++)
>     ...      ...        ...
> 20  0040105E 39 4D F4   cmp dword ptr [ebp-0Ch],ecx
>     ...      ...        ...
>         { power *= 2;
>     ...      ...        ...
> 23  00401066 D1 E2      shl edx,1
>     ...      ...        ...
>         return sum;
>     ...      ...        ...
> 35  0040107F C3         ret
> ```
> 
> 其中，机器级代码行包括行号、虚拟地址、机器指令和汇编指令。
> 
> 请回答下列问题。
> 
> (1) 计算机 M 是 RISC 还是 CISC？为什么？
> 
> (2) f1 的机器指令代码共占多少字节？要求给出计算过程。
> 
> (3) 第 20 条指令 cmp 通过 i 减 n-1 实现对 i 和 n-1 的比较。执行 f1(0) 过程中，当 i=0 时，cmp 指令执行后，进 / 借位标志 CF 的内容是什么？要求给出计算过程。
> 
> (4) 第 23 条指令 shl 通过左移操作实现了 `power*2` 运算，在 f2 中能否也用 shl 指令实现 `power*2`？为什么？
### 解
> [!done]+
> (1) M 为 CISC。观察题 44 图，指令 1 的内容为 `55H`，指令长 8 位，指令 20 的内容为 `394DF4H`，指令长 24 位，显然 M 的指令长短不一，不符合 RISC 指令系统特点。
> 
> (2) f1 的机器代码占 96B。因为 f1 的指令 1 所在的虚拟地址为 `00401020H`，最后一条指令即指令 35 所在的虚拟地址为 `0040107FH`，指令 35 的内容为 `C3H`，指令长 8 位，计算机 M 按字节编址，指令 35 占一个地址单元。f1 的机器指令代码占 `0040107FH+1H-00401020H=60H=96` 个地址单元，又因为计算机 M 按字节编址，所以 f1 的机器指令代码共占 96 字节。
> 
> (3) CF=1。`cmp` 指令实现 i 与 n-1 的比较功能，i<=n-1，即 i-(n-1)<0 或 `i==(n-1)`，i-(n-1) 进行的是减法运算。在执行 f1(0) 过程中，n=0，当 i=0 时，i=`00000000H`，n-1=`FFFFFFFFH`。因此，当执行指令 20 时，在补码加 / 减运算器中执行 `00000000H-FFFFFFFFH`，被减数和减数都视为无符号数，显然 `00000000H` 不够减 `FFFFFFFFH`，要向最高位的更高一位借 1，出现借位，所以 CF=1。
> 
> (4) f2 中不能用 `shl` 指令实现 `power*2`。因为 `shl` 指令用来将一个整数的所有有效数位作为一个整体左移，但 f2 中的变量 `power` 是 `float` 型，按照 IEEE754 标准，其机器数中不包含最高有效数位，但包含了阶码部分，将其作为一个整体左移时并不能实现乘以 2 的功能，所以 f2 中不能用 `shl` 指令实现 `power*2`。
> 浮点数运算比整型运算要复杂，耗时也较长。