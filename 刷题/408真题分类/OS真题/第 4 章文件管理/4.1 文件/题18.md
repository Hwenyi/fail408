---
publish: true
tags: []
aliases: 
finished: true
title: 题18
created: 2024-11-06 07:11
updated: 2024-11-08 13:49
---
## 题18
### 题目
【2014 统考真题】文件 $F$ 由 200 条记录组成,记录从 1 开始编号。用户打开文件后,欲将内存中的一条记录插入文件 $F$ ,作为其第 30 条记录。请回答下列问题,并说明理由。
1. 若文件系统采用连续分配方式,每个磁盘块存放一条记录,文件 $F$ 存储区域前后均有足够的空闲磁盘空间,则完成上述插入操作最少需要访问多少次磁盘块? $F$ 的文件控制块内容会发生哪些改变?
2. 若文件系统采用链接分配方式, 每个磁盘块存放一条记录和一个链接指针, 则完成上述插入操作需要访问多少次磁盘块? 若每个存储块大小为 $1{KB}$ ,其中 $4\;B$ 存放链接指针, 则该文件系统支持的文件最大长度是多少?
### 分析
~~第一问中，我是站在数组插入的角度去思考的，也就是插入第31个，从31开始，到最后都要调整自己，但是连续分配中访存的调整，是看前面的元素，不是后面的~~
![|300](https://img.hwenyi.tech/202411082035260.webp)
第二问还是一个关键想法，就是“索引”的长度，决定了可以覆盖多大的地址空间，每一个“索引编号”和一个磁盘块是一一对应的
![|300](https://img.hwenyi.tech/202411082146815.webp)
### 解
【参考答案】
(1) 采用连续分配方式，文件顺序存放，将内存中的一条记录插入文件作为第30条记录，则使文件的前29条记录向前移，可使得访问磁盘数最少。每移动一条记录都需要读取和写入各访盘一次，移动29条记录共需访问29×2=58次磁盘，写入第30条记录需访问一次磁盘，则完成上述插入操作最少需要访问59次磁盘块。(1分)
F的文件控制块中，文件的起始块号和文件长度会发生改变。(1分)
(2) 采用链接分配方式，插入记录只需找到记录的前一块盘块，修改指针即可。插入第30条记录，需要找到第29条记录的盘块，此时访问29次盘块。把29块的下址部分分配给新块，访盘一次，再使29块的指针指向新块，访盘一次(1分)，总共访问磁盘31次。(1分)
存储块的下块地址指针占4B即32位，可寻址232个盘块，数据部分占1KB-4B=1020B，则文件最大长度为232×1020B=4080GB

