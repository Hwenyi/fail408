---
publish: true
tags: []
aliases: 
finished: true
title: 题5
created: "2024-11-05 23:12"
updated: "2024-12-16 12:15"
---
## 题5
### 题目
【2016 统考真题】某磁盘文件系统使用链接分配方式组织文件, 簇大小为 $4{KB}$ 。目录文件的每个目录项包括文件名和文件的第一个簇号, 其他簇号存放在文件分配表 FAT 中。
1) 假定目录树如下图所示，各文件占用的簇号及顺序如下表所示，其中 dir、dirl 是目录, file1、file2 是用户文件。请给出所有目录文件的内容。
![](https://img.hwenyi.tech/202407291547084.webp)

| 文件名 | 簇号        |
| ---- | ----------- |
| dir  | 1           |
| dirl | 48          |
| file1 | 100、106、108|
| file2 | 200、201、202|

2) 若 FAT 的每个表项仅存放簇号,占 $2\;B$ ,则 FAT 的最大长度为多少字节? 该文件系统支持的文件长度最大是多少?
3) 系统通过目录文件和 FAT 实现对文件的按名存取, 说明 file1 的 106,108 两个簇号分别存放在 FAT 的哪个表项中。
4) 假设仅 FAT 和 dir 目录文件已读入内存, 若需将文件 dir/dir1/file1 的第 5000 个字节读入内存, 则要访问哪几个簇?
### 分析
[[刷题/25OS-王道/第 4 章 文件管理/综合题/题9]]
### 解
1. dir和dir1的内容如下所示： ![](https://img.hwenyi.tech/202411091344955.webp)
2. FAT的每个表项仅存放簇号，占2B = 16b，在FAT中最多有2^16个表项，即2^16个簇。FAT的最大长度为2^16 x 2B = 128KB。文件的最大长度为2^16 x 4KB = 256MB。
3. 按簇分配的文件中，FAT的每个表项存放文件的下一簇号，file1的106簇号放在FAT的100号表项中，108簇号放在FAT的106号表项中。
4. 首先在dir目录文件中找到dir1的簇号48，读取48号簇，找到dir1目录文件；在dir1目录文件中找到file1文件的第一个簇号100，无需读取100号簇，只需根据此簇号在FAT表中找到第5000个字节所在的簇号，由于一个簇为4KB = 4096B，可知5000B在文件的第二个簇即106号簇中，所以需要访问目录文件dir1的48号簇，和文件file1的106号簇。