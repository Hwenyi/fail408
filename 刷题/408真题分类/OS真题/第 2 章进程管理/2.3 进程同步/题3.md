---
publish: true
tags: 
aliases: 
finished: true
title: 题3
created: 2024-11-02 07:00
updated: 2024-11-05 00:47
---
## 题3
### 题目
【2011】有两个并发执行的进程 ${P}_{1}$ 和 ${P}_{2}$ ,共享初值为 1 的变量 $x$ 。 ${P}_{1}$ 对 $x$ 加 1, ${P}_{2}$ 对 $x$ 减 1 。加 1 和减 1 操作的指令序列分别如下所示: 
```cpp
// 加 1 操作
load R1, x // 取 x 到寄存器 R1 中
inc R1
store x, R1 // 将 R1 的内容存入 x

// 减 1 操作
load R2, x
dec R2
store x, R2
```
两个操作完成后, $x$ 的值( )。
A. 可能为-1 或 3
B. 只能为 1
C. 可能为 0、1 或 2
D. 可能为 $- 1\text{、}0\text{、}1$ 或 2
### 分析
这里没有任何互斥上锁的机制，而且还用了中间变量R1和R2来间接操作x，也就是说，可以把两个中间变量断点停住，最后形成覆盖更新
### 解
【参考答案】C
【解析】本题对 P1 与 P2 的执行顺序没有规定，可能会出现以下 3 种情况：
① P1 先执行，P2 后执行。
P1：读取 x = 1，x = x + 1 = 2，写入 x = 2
P2：读取 x = 2，x = x - 1 = 1，写入 x = 1
执行完 P1、P2，x = 1。
② P2 先执行，P1 后执行。
P2：读取 x = 1，x = x - 1 = 0，写入 x = 0
P1：读取 x = 0，x = x + 1 = 1，写入 x = 1
执行完 P1、P2，x = 1。
③ P1、P2 并发进行。x → R1 = 1，x → R2 = 1，x = x + 1 = 2，x = x - 1 = 0
以上是 P1、P2 并发进行的情况，而进程的最后一步无法并发进行，因而会出现：R1 - x = 2，R2 - x = 0
执行完 P1、P2，x 可能为 2，也可能为 0。
综上所述，x 的值可能为 0、1 或 2，故本题选 C。
