---
publish: true
tags: 
aliases: 
finished: true
title: 题15
created: "2024-11-17 18:18"
updated: "2024-11-22 14:10"
---
## 题15
### 题目
【2009 统考真题】某网络拓扑如下图所示，路由器 R1 通过接口 E1、E2 分别连接局域网 1、局域网 2，通过接口 L0 连接路由器 R2，并通过路由器 R2 连接域名服务器与互联网。R1 的 L0 接口的 IP 地址是 202.118.2.1；R2 的 L0 接口的 IP 地址是 202.118.2.2，L1 接口的 IP 地址是 130.11.120.1，E0 接口的 IP 地址是 202.118.3.1；域名服务器的 IP 地址是 202.118.3.2。

![](https://img.hwenyi.tech/202411222207643.webp)

R1 和 R2 的路由表结构为： 
$\begin{array}{|c|}\hline \text{目的网络 IP 地址}&\text{子网掩码}&\text{下一跳 IP 地址}&\text{接口}\\\hline \end{array}$

(1) 将 IP 地址空间 202.118.1.0/24 划分为 2 个子网，分别分配给局域网 1、局域网 2，每个局域网需分配的 IP 地址数不少于 120 个。请给出子网划分结果，说明理由或给出必要的计算过程。

(2) 请给出 R1 的路由表，使其明确包括到局域网 1 的路由、局域网 2 的路由、域名服务器的主机路由和互联网的路由。

(3) 请采用路由聚合技术，给出 R2 到局域网 1 和局域网 2 的路由。
### 分析
[[刷题/408历年真题解析/2009年408真题计算机网络篇/题47]]
[[刷题/408真题分类/计网真题/第 4 章网络层/4.2 IPv4/题19]]
### 解
1) 子网号可以全 0 或全 1 , 但主机号不能全 0 或全 1 。

因此若将 IP 地址空间 202.118.1.0/24 划分为 2 个子网,且每个局域网需分配的 IP 地址个数不少于 120 个, 则子网号至少要占用 1 位。

由 $2^{6} - 2 < 120 < 2^{7} - 2$ 可知,主机号至少要占用 7 位。

因为源 IP 地址空间的网络前缀为 24 位,所以主机号位数 + 子网号位数 $= 8$ 。

综上可得主机号位数为 7 , 子网号位数为 1 。

2) 因此子网的划分结果为子网 1: 子网地址为 202.118.1.0, 子网掩码为 255.255.255.128 (或子网 1: 202.118.1.0/25); 子网 2: 子网地址为 202.118.1.128, 子网掩码为 255.255.255.128 (或子网 2: 202.118.1.128/25)。

地址分配方案: 子网 1 分配给局域网 1 , 子网 2 分配给局域网 2 ; 或者子网 1 分配给局域网 2 , 子网 2 分配给局域网 1 。

因为局域网 1 和局域网 2 分别与路由器 R1 的 E1、E2 接口直接相连, 所以在 R1 的路由表中, 目的网络为局域网 1 的转发路径是直接通过接口 E1 转发的, 目的网络为局域网 2 的转发路径是直接通过接口 $E2$ 转发的。因为局域网 1、2 的网络前缀均为 25 位,所以它们的子网掩码均为 $255.255.255.128$ 。

域名服务器是一台特定的主机, 它指明了其 IP 地址, 因此设定 1 条特定主机路由, 该表项的子网掩码为 255.255.255.255 (只有和全 1 的子网掩码相与时, 才能保证和目的 IP 地址一样, 从而选择该特定路由)。对应的下一跳地址是 202.118.2.2, 转发接口是 L0。

R1 到互联网的路由实质上相当于一个默认路由 (即当某一目的 IP 地址与路由表中其他任何表项都不匹配时, 则匹配该默认路由。互联网包括了无数的网络集合, 不可能在路由表项中一一列出, 因此只能采用默认路由的方式), 默认路由一般写为 $0/0$ ,即目的地址为 $0.0.0.0$ ,子网掩码为 $0.0.0.0$ 。对应的下一跳地址是 202.118.2.2,转发接口是 L0。综上可得到路由器 R1 的路由表如下:

(若子网 1 分配给局域网 1 , 子网 2 分配给局域网 2 )

<table><tr><td>目的网络 IP 地址</td><td>子网掩码</td><td>下一跳 IP 地址</td><td>接口</td></tr><tr><td>202.118.1.0</td><td>255.255.255.128</td><td>$-$</td><td>E1</td></tr><tr><td>202.118.1.128</td><td>255.255.255.128</td><td>$-$</td><td>E2</td></tr><tr><td>202.118.3.2</td><td>255.255.255.255</td><td>202.118.2.2</td><td>L0</td></tr><tr><td>0.0.0.0</td><td>0.0.0.0</td><td>202.118.2.2</td><td>L0</td></tr></table>

(若子网 1 分配给局域网 2, 子网 2 分配给局域网 1)

<table><tr><td>目的网络 IP 地址</td><td>子网掩码</td><td>下一跳 IP 地址</td><td>接口</td></tr><tr><td>202.118.1.128</td><td>255.255.255.128</td><td>$-$</td><td>E1</td></tr><tr><td>202.118.1.0</td><td>255.255.255.128</td><td>$-$</td><td>E2</td></tr><tr><td>202.118.3.2</td><td>255.255.255.255</td><td>202.118.2.2</td><td>L0</td></tr><tr><td>0.0.0.0</td><td>0.0.0.0</td><td>202.118.2.2</td><td>L0</td></tr></table>

3) 局域网 1 和局域网 2 的地址可以聚合为 202.118.1.0/24, 而对于路由器 R2 来说, 通往局域网 1 和局域网 2 的转发路径都是从 L0 接口转发的, 因此采用路由聚合技术后, 路由器 R2 到局域网 1 和局域网 2 的路由如下:

<table><tr><td>目的网络 IP 地址</td><td>子网掩码</td><td>下一跳 IP 地址</td><td>接口</td></tr><tr><td>202.118.1.0</td><td>255.255.255.0</td><td>202.118.2.1</td><td>L0</td></tr></table>
