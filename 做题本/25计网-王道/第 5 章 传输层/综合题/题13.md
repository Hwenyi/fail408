---
publish: true
tags: []
aliases: 
finished: true
title: 题13
created: "2024-11-17 18:15"
updated: "2024-11-19 13:01"
---
## 题13
### 题目
【2012】主机H通过快速以下网连接 Internet,IP 地址为 192.168.0.8 , 服务器S的 IP 地址为 211.68.71.80。H与S使用 TCP 通信时,在H上捕获的其中 5 个 IP 分组如表 (a) 所示。回答下列问题: 
(1) 表 (a) 中的 $\mathrm{{IP}}$ 分组中,哪几个是由 $\mathrm{H}$ 发送的? 以太网传输时进行了填充? 
(2) 根据表 (a) 中的 IP 分组, 分析 S 已经收到的应用层数据字节数是多少? 
(3) 若表 (a) 中的某个 IP 分组在 $\mathrm{S}$ 发出时的前 40 字节如表 (b) 表所示,则该 $\mathrm{{IP}}$ 分组到达 $\mathrm{H}$ 时经过少个路由器?
![](https://img.hwenyi.live/202411191302924.webp)
![](https://img.hwenyi.live/202411191302829.webp)
### 分析
[[刷题/408真题分类/计网真题/第 5 章传输层/题19]]
### 解
1) 由图 1 看出,源 IP 地址为 IP 分组头的第 13 10 个字节。在表 1 中, $1、3、4$ 号分组的源 IP 地址均为 $192.168.0.8$ (c0a80008H),所以 $1、3、4$ 号分组是由 $H$ 发送的。再观察  $1,3,4$ 号分组的标识字段,分别是 $9\;b,9c,9\;d$ ,标识字段是一个计数器,每产生一个数据报就加 1,这也说明主机 $H$ 先后发送了 $1,3,4$ 号分组。
在表 1 中,1 号分组封装的 TCP 段的 $\mathrm {{SYN}} = 1,\mathrm {{ACK}} = 0,\mathrm {{seq}} = {846}\;b{41}c5H;2$ 号分组封装的 TCP 段的 $\mathrm {{SYN}} = 1,\mathrm {{ACK}} = 1,\mathrm {{seq}} = e{0599}\mathrm {{ffefH}} ,\mathrm {{ack}} = {846}\;b{41}c6H;3$ 号分组封装的  $\mathrm {{TCP}}$ 段的 $\mathrm {{ACK}} = 1,\mathrm {{seq}} = {846}\;b{41}c6H,\mathrm {{ack}} = e{0599}\mathrm {{ff}} 0H$ ,所以$1、2、3$号分组完成了 TCP  连接的建立过程。
由于快速以太网数据帧有效载荷的最小长度为 ${46}\;B$ ,表 1 中 3、5 号分组的总长度为 40  (28H) 字节,小于 ${46}\;B$ ,其余分组总长度均大于 ${46}\;B$ 。所以 $3、5$ 号分组通过快速以太网传输时需要填充。
2) 由 3 号分组封装的 TCP 段可知,发送应用层数据初始序号为 $\operatorname{seq} = {846}\;b{41}c6H$ ,由 5 号分组封装的 TCP 段可知, $\mathrm {{ack}}$ 为 $\mathrm {{seq}} = {846}\;b{41}d6H$ ,所以 $S$ 已经收到的应用层数据的字节数为 ${846}\;b{41}\;d6H - {846}\;b{41}c6H = {10}H = {16}\;B$ 。
3) 因为 $S$ 发出的 IP 分组的标识 $= {6811}H$ ,所以该分组所对应的是表 1 中的 5 号分组。 $S$ 发出的 IP 分组的 TTL $= {40}H = {64},5$ 号分组的 TTL $= {31}H = {49},{64} - {49} = {15}$ ,所以可以推断该IP 分组到达 $H$ 时经过了 15 个路由器。
