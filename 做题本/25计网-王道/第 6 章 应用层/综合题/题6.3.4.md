---
publish: true
tags: []
aliases: 
finished: true
title: 题6.3.4
created: "2024-11-17 08:44"
updated: "2024-12-16 06:47"
---
## 题6.3.4
### 题目
> [!question]+
> 【2023 统考真题】某网络拓扑如题 47 图所示，主机 H 登录 FTP 服务器后自服务器上估一个大小为 18000B 的文件 F，假设 H 传输 F 建立数据连接时，**选择的初始序号为 100**，MSS=1000B，拥塞控制初始阈值为 4MSS，RTT=10ms，忽略 TCP 的传输时延，在 F 的传输过程中，H 以 MSS 段向服务器发送数据，且未发生差错。丢包和乱序。
> ![](https://img.hwenyi.live/202411191929965.webp)
> (1) FTP 的控制连接是持久的还是非持久的？FTP 的数据连接是持久的还是非持久的？H 登录 FTP 服务器时，建立的 TCP 连接是控制连接还是数据连接？
> (2) H 通过数据连接发送 F 时，F 的第一个字节序号是多少？在断开数据连接的过程中，FTP 发送的第二次挥手的 ACK 序号是？
> (3) F 发送过程中，当 H 收到确认序号为 2101 的确认段时，H 的拥塞窗口调整为多少？收到确认序号为 7101 的确认段时，H 的拥塞窗调整为多少？
> (4) H 从请求建立数据连接开始，到确认 F 已被服务器全部接收为止，至少需要多长时间，期间应用层数据平均发送速率是多少？
### 分析
> [!NOTE]+
> [[FTP文件传输协议-TCP封装|FTP]]的控制连接是持久的，数据是非持久的，控制连接建立连接
> ![](https://img.hwenyi.live/202411192002552.webp)
### 解
> [!done]+
> [[刷题/408历年真题解析/2023年408真题计算机网络篇/题47]]
> 1. 在 FTP 会话期间, 控制连接一直处于保持状态, 是持久的。当每次需要传输文件时, FTP 客户和服务器之间会建立一个临时的数据连接, 用于传输文件数据, 是非持久的。控制连接用于传输命令和控制信息, 登录操作涉及身份验证、发送命令等控制信息, 因此 $H$ 登录 FTP 服务器时建立的 TCP 连接是控制连接。
> 2. 建立连接时, FTP 客户发送的第一次握手 SYN 段要消耗一个序号, 选择的初始序号为 100, 因此发送文件 $F$ 时,第一个字节的序号为 101 。文件 $F$ 共有 18000 个字节,需占用 18000 个 序号, 释放连接时, FTP 客户发送的第一次挥手 FIN 段也要消耗一个序号, 所以该 FIN 段的 序号为 18101, 因此 TCP 服务器发送的第二次挥手 ACK 段的确认序号是 18102。
> 3. 拥塞窗口在每个传输轮次后的变化如下表所示。前两个传输轮次, 拥塞窗口小于阈值, 拥塞窗口按指数增长; 第 2 个传输轮次结束后, 拥塞窗口增长到 4MSS, 此后每经过一个传输轮次,拥塞窗口增加 1MSS。当 $H$ 收到确认序号为 2101 的确认段时,表示服务器已收到 ${2000}\;B$ 数据,即 2 个报文段,此时还处在第 2 个传输轮次 (慢开始阶段),拥塞窗口还未达到阈值,发送方每收到一个确认,拥塞窗口就加 1 ,所以此时拥塞窗口为 $2 + 1 =$ 3MSS。当 $H$ 收到确认序号为 7101 的确认段时,表示服务器已收到 7 个报文段,第 3 轮 传输结束后,发送方共发送了 $1 + 2 + 4 = 7{MSS}$ 数据,所以拥塞窗口大小为 $5{MSS}$ 。
> 
> | N                | 初始时  | $N = 1$ | $N = 2$ | $N = 3$ |
> | ---------------- | ---- | ------- | ------- | ------- |
> | $N$ 个传输轮次后拥塞窗口大小 | 1MSS | 2MSS    | 4MSS    | 5MSS    |
> 4) 每个传输轮次传输的数据量如下表所示,文件 $F$ 的大小 ${18000}\;B = {18}{MSS}$ ,则发送完 $F$ 要 经过 5 个 RTT, 此外还要 1 个额外的 RTT 用来建立 TCP 连接。因此, H 从请求建立数据 连接开始,到确认 $F$ 已被服务器全部接收为止,至少需要 $6{RTT} = 6 \times {10}\;{ms} = {60}\;{ms}$ ; 期间应用层数据平均发送速率是 ${18000}\;B \div {60}\;{ms} = {300} \times {10}^{3}\;B/s = {0.3}{MB}/s = {2.4}{Mb}/s$ 。
> 
> | $k$ | $k = 1$ | $k = 2$ | $k = 3$ | $k = 4$ | $k = 5$ |
> | --- | --- | --- | --- | --- | --- |
> | 第 $k$ 轮最大数据传输量 | 1MSS | 2MSS | 4MSS | 5MSS | 6MSS |