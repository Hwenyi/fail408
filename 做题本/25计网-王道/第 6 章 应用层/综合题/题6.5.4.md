---
publish: true
tags: []
aliases: 
finished: true
title: 题6.5.4
created: "2024-11-17 08:44"
updated: "2024-11-19 08:09"
---
## 题6.5.4
### 题目
【2021 统考真题】某网络拓扑如题 47 图所示，以太网交换机 S 通过路由器 R 与 Internet 互联。路由器部分接口、本地域名服务器、H1、H2 的 IP 地址和 MAC 地址如图中所示。在 $t_0$ 时刻 H1 的 ARP 表和 S 的交换表均为空，H1 在此刻利用浏览器通过域名 $\text{www.abc.com}$ 请求访问 Web 服务器，在 $t_1$ 时刻（ $t_1>t_0$ ）S 第一次收到了封装 HTTP 请求报文的以太网帧，假设从 $t_0$ 到 $t_1$ 期间网络未发生任何与此次 Web 访问无关的网络通信。
![](https://img.hwenyi.live/202411171631661.webp)
请回答下列问题。
(1) 从 $t_0$ 到 $t_1$ 期间，H1 除了 HTTP 之外还运行了哪个应用层协议？从应用层到数据链路层，该应用层协议报文是通过哪些协议进行逐层封装的？
(2) 若 S 的交换表结构为：<MAC 地址，端口 >，则 $t_1$ 时刻 S 交换表的内容是什么？
(3) 从 $t_0$ 到 $t_1$ 期间，H2 至少会接收到几个与此次 Web 访问相关的帧？接收到的是什么帧？帧的目的 MAC 地址是什么？
### 分析
[[刷题/408真题分类/计网真题/第 6 章应用层/6.5 万维网(www)/题6]]
### 解
1. 从 ${t}_{0}$ 到 ${t}_{1}$ 期间,除了 HTTP, $H1$ 还运行了 DNS 应用层协议,以将域名转换为 IP 地址。 DNS 运行在 UDP 之上, UDP 将应用层交付的 DNS 报文添加首部后, 向下交付给 IP 层, IP 层使用 IP 数据报进行封装, 封装好后, 向下交付给数据链路层, 数据链路层使用 CSMA/CI 帧进行封装。因此, 逐层封装关系如下: DNS 报文一UDP 数据报一IP 数据报 $\rightarrow$ CSMA/CD 帧。 传统以太网在数据链路层采用 CSMA/CD 协议, 因此使用 CSMA/CD 帧进行封装。
提示: 在数据链路层对该报文的封装解释为以太网 V2 帧 (或以太网帧) 会更合适, 标准 答案给出的 CSMA/CD 帧相对而言并不算特别合适。CSMA/CD 协议更多地用在以传统集线器互连的以太网中。交换机可工作于全双工方式, 通常不采用 CSMA/CD 协议。
2.  ${t}_{0}$ 时刻, $H1$ 的 ARP 表和 S 的交换表为空。 $H1$ 利用浏览器通过域名请求访问 Web 服务器。 因为要先解析域名, 查询该域名对应的 IP 地址, 所以要先向本地域名服务器发送 DNS 查询 报文。ARP 表为空, 因此需要先发送 ARP 请求分组, 查询本地域名服务器对应的 MAC 地 址, 这个帧的目的 MAC 地址是 FF-FF-FF-FF-FF-FF。S 接收到这个帧, 在交换表中记录 MAC 地址为 00-11-22-33-44-cc, 位于端口 4, 然后广播该帧。当本地域名服务器收到 ARP请求后,向 $H1$ 发送 ARP 响应分组。 $S$ 接收到这个帧,在交换表中记录 MAC 地址为 00-11-22-33-44-bb，位于端口 1，然后将该帧从端口 4 发送出去。
得到了域名对应的 IP 地址, 发现不在本局域网中, 需要通过路由表转发。
$H1$ 的 ARP 表中没有路由器对应的 MAC 地址,因此需要先发送 ARP 请求分组,查询路 由器对应的 MAC 地址, 这个帧的目的 MAC 地址是 FF-FF-FF-FF-FF-FF。S 接收到这个帧, 广播该帧。当路由器收到 ARP 请求后, 向 H1 发送 ARP 响应分组。S 接收到这个帧, 在 交换表中记录 MAC 地址为 00-11-22-33-44-aa, 位于端口 2, 然后将该帧从端口 4 发送出 去。现在, H1 就能发送 HTTP 请求。在整个过程中, 并没有涉及 H2, H2 没有主动发送 数据,因此 $S$ 不会记录 $H2$ 的 MAC 地址和端口, ${t}_{1}$ 时刻 $S$ 的交换表如下所示。
<table><thead><tr><th>MAC 地址</th><th>端口</th></tr></thead><tr><td>00-11-22-33-44-cc</td><td>4</td></tr><tr><td>00-11-22-33-44-bb</td><td>1</td></tr><tr><td>00-11-22-33-44-aa</td><td>2</td></tr></table>
3. 由步骤 2) 的分析可知, $H2$ 至少会接收到 2 个和此次 Web 访问相关的帧。接收到的均是 封装 ARP 查询报文的以太网帧; 这些帧的目的 MAC 地址均是 FF-FF-FF-FF-FF-FF。