---
publish: true
tags: []
aliases: 
finished: true
title: 题17
created: 2024-11-06 07:11
updated: 2024-11-08 12:11
TARGET DECK: 刷题::408真题分类::OS真题::第 4 章文件管理::4.1 文件::题17
error: true
---
## 题17
### 题目
Q:【2012 统考真题】某文件系统空间的最大容量为 `4TB` ( `1TB = 2^40 B` ),以磁盘块为基本分配单位。
磁盘块大小为 `1KB` 。文件控制块（FCB）包含一个 `512 B` 的索引表区。请回答下列问题:
1. 假设索引表区仅采用**直接索引结构**，索引表区存放文件占用的**磁盘块号**，**索引表项**中**块号**最少占多少字节? 可支持的单个文件的最大长度是多少字节?
2. 假设索引表区采用如下结构：第 0 ~ 7 字节采用`<起始块号, 块数>`格式表示文件创建时预分配的连续存储空间。其中起始块号占 `6 B` ,块数占 `2 B` ,剩余 504B 采用直接索引结构, 一个索引项占 `6B`, 则可支持的单个文件的最大长度是多少字节? 为使单个文件的长度达到最大, 请指出起始块号和块数分别所占字节数的合理值并说明理由。
### 分析
A:直接索引结构，应该就是只有一级的意思，直接指针指向磁盘块
有空间总量，有一个磁盘块的大小，可以算出来一共有多少块，每一个块是一个分配单位，我们的索引表要能覆盖所有的块数
整张表是512B这么大，除以每一个条目（项）的大小，就是可以覆盖多少个盘块，也就是多少个$1KB$的磁盘块，每一个$1KB$的磁盘块是被4字节索引的
![](https://img.hwenyi.live/202411082006806.webp)
### 解
1. 文件系统中所能容纳的磁盘块总数为 4TB/1KB = 2^32 块。因此索引表项中的块号至少要占 4 个字节，才能表示所有的块号。
直接索引结构中，文件的盘块号直接记录在索引表中，可表示 512B/4B = 128 个盘块，可支持单个文件的最大长度为 128 x 1KB = 128KB。
2. 所求单个文件最大长度包含两部分：预分配的连续空间和直接索引部分。
连续空间块数占 2B，可表示 2^16 块，占 2^16 x 1KB = 64KB。直接索引部分包括 504B/6B = 84 个索引项，可表示 84 块，占 84KB。因此该系统可支持的单个文件最大长度为 64KB + 84KB = 148KB。
起始块号和块数分别所占字节数的合理值分别为 4, 4（或 1, 7 或 2, 6 或 3, 5）。
系统空间的最大容量为 4TB，占 2^32 块，用 32/8 = 4B 表示块数，可以表示 4TB 的文件，为最大文件长度。
<!--ID: 1731146756227-->

