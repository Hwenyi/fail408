---
publish: true
tags: [操作系统, cpu, MMU, 地址, 虚拟化, TLB, cache, 内存, 计算机系统, 题目/选择题, 做错了, 操作系统, cpu, MMU, 虚拟化, 地址, TLB, cache, 内存, 计算机系统]
aliases: 
finished: true
title: 题18
created: "2024-12-12 09:41"
updated: "2024-12-13 16:47"
TARGET DECK: 刷题::408真题分类::24年408真题::题18
error: true
---
## 题18
### 题目
下列事件中,不是在MMU地址转换过程中检测的是 ( )。
A. 访问越权 
B. Cache缺失 
C. 页面缺失 
D. TLB缺失
### 分析

我的直觉中，前半部分的认识是对的，[[MMU]]负责[[物理地址]]和[[虚拟地址]]之间的转换，但是题目问的是转换过程中会发生的错误，而不是得到了物理地址之后，从[[cache]]读数据的问题，这不是题目所问的范围

你提到：

> ~~MMU（地址转换机构）将虚拟地址转换为物理地址。TLB缺失是可能的，因为TLB存储物理地址，如果其中没有相关的映射，就会缺失。如果TLB中没有存储，则会去页面中查找。页面也可能缺失（未调入物理页面）。即使物理内存存在于Cache中，如果读取Cache时发生Cache缺失，我感觉只能选择A。~~

你的直觉是：MMU 地址转换过程中，如果最终访问 Cache 发生 Cache 缺失，那么这应该也是 MMU 地址转换过程中的检测事件。

**错误之处在于**：

- **MMU 的职责是地址转换**：MMU（内存管理单元）的核心任务是将虚拟地址转换为物理地址，它主要关注的是地址映射和权限检查。
- **Cache 的职责是加速访问**：Cache 是一个高速缓存，目的是为了减少 CPU 直接访问主存的次数，从而提高数据访问速度。
- **两者是独立的阶段**：MMU 的地址转换发生在 CPU 访问主存之前。Cache 的访问发生在获得物理地址之后，是一个独立的阶段。

**具体来说**：

1. **MMU 地址转换过程**：
    - CPU 发出虚拟地址。
    - MMU 根据虚拟地址查找页表（可能通过 TLB 加速），得到物理地址。
    - MMU 进行访问权限检查（例如，检查是否越权）。
    - 如果发生页面缺失，会触发缺页中断，由操作系统处理。
    - **此时，地址转换过程结束，已经得到物理地址**。

2. **Cache 访问过程**：
    - CPU 使用 MMU 转换后的物理地址，尝试访问 Cache。
    - 如果 Cache 命中，则直接读取 Cache 中的数据。
    - 如果 Cache 未命中，则访问主存，并将数据加载到 Cache 中。
    - **Cache 的访问过程是在物理地址已经生成之后发生的**。

**所以**，Cache 缺失不是在 MMU 地址转换过程中检测的事件，而是发生在地址转换之后，CPU 访问物理内存时的一个过程。

**为什么 Cache 缺失不是 MMU 的检测事件？**

- **MMU 只管地址翻译和权限检查**：MMU 的工作是确保地址翻译的正确性和安全性，它并不关心数据是否在 Cache 中。
- **Cache 对用户程序是透明的**：Cache 是一个硬件加速机制，用户程序并不知道 Cache 的存在，它只是发出逻辑地址，操作系统负责将其转换为物理地址，然后交给硬件去访问，程序不需要去感知cache。
- **Cache 缺失属于访存阶段**：当物理地址已经产生，CPU 要去取数据时，才有可能发生 Cache 缺失，而这并不属于 MMU 的地址转换过程。

**访问 Cache 的时机**

- **CPU 发出内存访问请求后**：当 CPU 需要读取或写入内存时，会发出内存访问请求。
- **物理地址生成后**：在 MMU 将虚拟地址转换为物理地址后，CPU 才会使用物理地址去访问 Cache。
- **Cache 查询**：CPU 使用物理地址查询 Cache 中是否存在对应的数据块。

**访问 Cache 与解析虚拟地址之间的关系**

1. **依赖关系**：
    - 解析虚拟地址（MMU 地址转换）是访问 Cache 的前提。只有获得物理地址后，才能使用物理地址去访问 Cache。
    - Cache 的命中与否不会影响地址转换过程。

2. **独立性**：
    - MMU 和 Cache 是两个独立的硬件模块，各自负责不同的任务。
    - MMU 完成地址转换后，Cache 才开始发挥作用。

**总结**

- 你的直觉错误在于把 Cache 缺失当成了 MMU 地址转换过程的一部分，实际上它是访问主存过程的一部分。
- MMU 负责虚拟地址到物理地址的转换，以及权限检查。
- Cache 负责加速 CPU 访问主存的速度，它是位于 CPU 和主存之间的缓冲存储器。
- MMU 的地址转换先于 Cache 的访问。
- Cache 是一个硬件加速机制，对于用户程序是透明的，用户程序不需要知道cache的存在。

### 解
[[刷题/408历年真题解析/2024年408真题计算机组成原理篇/题18]]

