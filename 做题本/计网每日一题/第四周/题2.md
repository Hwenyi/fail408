---
publish: true
tags: []
aliases: 
finished: true
title: 题2
created: "2024-11-21 03:57"
updated: "2024-12-06 01:11"
---
## 题2
### 题目
下图所示为IPv4数据报首部的固定格式(不包含可选字段)：
![](https://img.hwenyi.live/202411211154746.webp)
现有某个IPv4数据报，其首部采用固定格式、数据载荷是长度为40B的ICMIP相关报文。以下是该IPv4数据报首部中部分字段的值：
版本：4、区分服务：0、标识： $0\mathbf{x}050\mathbf{e}$ 、标志：0、片偏移：0、生存时间：64
请给出以下字段的值：首部长度(十进制)总长度(十进制) 协议(十进制)首部检验和(十六进制)
### 分析
[[ipv4数据报的首部格式]]中的首部协议字段为1，表示这是封装的是[[ICMP网际控制报文协议|ICMP]]协议
### 解
![](https://img.hwenyi.live/202411211226168.webp)
![](https://img.hwenyi.live/202411211227028.webp)
![](https://img.hwenyi.live/202411211227322.webp)
![](https://img.hwenyi.live/202411211227046.webp)
IPV4首部检验和、TCP报文段检验和、UDP用户数据报检验和，三者统称为因特网检验和，都采用反码算术运算求和（最高位产生的进位，加到结果的最低位）。
计算TCP报文段检验和时，需要在TCP报文段前面添加12B的伪首部（源IP地址、目的IP地址、1字节全0的保留字节、取值为6的协议字段、TCP报文段长度）。
计算UDP用户数据报检验和时，需要在UDP用户数据报前面添加12B的伪首部（源IP地址、目的IP地址、1字节全0的保留字节、取值为17的协议字段、UDP用户数据报长度）。