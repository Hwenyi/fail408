---
publish: true
tags: 
aliases: 
finished: true
title: 题18
created: "2024-11-21 07:21"
updated: "2024-11-21 07:40"
---
## 题18
### 题目
> [!question]+
> 在采用 “取指、译码 / 取数、执行、访存、写回”5 段流水线的处理器中，执行如下指令序列，其中 s0、s1、s2、s3 和 t2 表示寄存器编号。
> 
> ```cpp
> I1: add s2,s1,s0    // R[s2]←R[s1]+R[s0]
> I2: load s3,0(t2)   // R[s3]←M[R[t2]+0]
> I3: add s2,s2,s3    // R[s2]←R[s2]+R[s3]
> I4: store s2,0(t2)  // M[R[t2]+0]←R[s2]
> ```
> 
> 下列指令对中，不存在数据冒险的是（ ）。
> 
> A. I1 和 I3
> 
> B. I2 和 I3
> 
> C. I2 和 I4
> 
> D. I3 和 I4
### 解
> [!done]+
> 常考的数据冒险有：**写后读（read after write, RAW）**数据冒险、**写后写（write after write, WAW）**数据冒险、**读后写（write after read, WRA）**数据冒险、**装入 - 使用（load-use）**数据冒险等。
> 
> 在按序发射，按序流动的流水线中，可能出现写后读（RAW）数据冒险和装入 - 使用（load-use）数据冒险。
> 
> A 错误。I1 和 I3 存在**写后读数据冒险（read after write Data Hazard, RAW Data Hazard）**：读取某数据操作必须在写入该数据操作之后执行，否则可能产生错误。这里 I3 读取 R[s2] 必须在 I1 写回 R[s2] 后执行，可以使用数据旁路解决。
> 
> B 错误。I2 和 I3 之间存在数据冒险，属于**装入 - 使用数据冒险（load-use Data Hazard）**：LOAD 指令和随后使用 LOAD 指令所加载数据的后续指令之间存在的依赖关系，即使用某数据操作必须在装入该数据之后执行，否则可能产生错误。仅用转发线路无法解决 I2 和 I3 之间的数据相关问题，需要用转发技术结合装入 - 使用阻塞解决。原因在于 I2 的功能是从内存中取数，只有在 M 段结束时才能从主存中得到 R[s3] 的新值，即先装入后使用，但 I3 的 EX 段就要用到 R[s3]，I3 需要阻塞 1 个时钟周期，等到 I2 的 M 段结束之后，从 I2 的 M→WB 流水段寄存器中取到 R[s3] 的新值。
> 
> C 正确。
> 
> D 错误。I3 和 I4 存在**写后读数据冒险（read after write Data Hazard, RAW Data Hazard）**：读取某数据操作必须在写入该数据操作之后执行，否则可能产生错误。这里 I4 读取 R[s2] 必须在 I3 写回 R[s2] 后执行，可以使用数据旁路解决。
> 
> 采用 NOP 指令进行阻塞，并采用数据旁路技术，指令的执行过程如图 (a) 所示。仅采用 NOP 指令进行阻塞，指令的执行过程如图 (b) 所示。
> 
> ![](https://pic4.zhimg.com/v2-d4d08c86cddb69f942ed7338e505436f_r.jpg)
> 
> 本题选 C。