---
publish: true
tags: 
aliases: 
finished: true
title: 题42
created: "2024-11-21 07:30"
updated: "2024-11-21 07:40"
---
## 题42
### 题目
> [!question]+
> （10 分）
> 
> 对含有 $n\,(n > 0)$ 个记录的文件进行外部排序，采用置换 - 选择排序生成初始归并段时需要使用一个工作区，工作区中能保存 $m$ 个记录，请回答下列问题。
> 
> ⑴ 若文件中含有 19 个记录，其关键字是 51, 94, 37, 92, 14, 63, 15, 99, 48, 56, 23, 60, 31, 17, 43, 8, 90, 166, 100；当 $m = 4$ 时，可以生成几个初始归并段？各是什么？
> 
> ⑵ 对任意的 $m \,(n \gg m > 0)$ ，生成的第一个初始归并段的长度最大值和最小值分别是多少？
### 解
> [!done]+
> 408 史上第一次对外部排序进行考察，本题要求模拟置换 - 选择排序的过程。
> 
> 假设初始待排序文件为输入文件 FI，初始归并段文件为输出文件 FO，内存工作区为 WA，FO 和 WA 初始为空，并设内存工作区 WA 的容量可容纳 w 个记录。则置换 - 选择排序的操作过程为：
> 
> - (1) 从 FI 输入 w 个记录到缓冲区 WA。
> - (2) 从 WA 中选出其中关键字取最小值的记录，记为 MINIMAX 记录。
> - (3) 将 MINIMAX 记录输出到 FO 中去。
> - (4) 若 FI 不空，则从 FI 输入下一个记录到 WA 中。
> - (5) 从 WA 中所有比 MINIMAX 记录的关键字大的记录中选出最小关键字记录，作为新的 MINIMAX 记录。
> - (6) 重复 (3)~(5)，直到在 WA 中选不出新的 MINIMAX 为止，由此得到一个初始归并段，输出归并段结束标志到 FO 中。
> - (7) 重复 (2)~(6)，直到 WA 为空，由此得到全部初始归并段。
> 
> ⑴ 对题目所给关键字序列进行置换 - 选择排序：
> 
> $\begin{array}{c|c|c} \rm FO &\rm WA&\rm FI \\\hline &&51, 94, 37, 92, 14, 63, 15, 99, 48, 56, 23, 60, 31, 17, 43, 8, 90, 166, 100\\ &51, 94, 37, 92&14, 63, 15, 99, 48, 56, 23, 60, 31, 17, 43, 8, 90, 166, 100\\ 37&51, 94, \quad, 92&14, 63, 15, 99, 48, 56, 23, 60, 31, 17, 43, 8, 90, 166, 100\\ 37&51, 94, 14, 92&63, 15, 99, 48, 56, 23, 60, 31, 17, 43, 8, 90, 166, 100\\ 37,51&\quad, 94, 14, 92&63, 15, 99, 48, 56, 23, 60, 31, 17, 43, 8, 90, 166, 100\\ 37,51&63, 94, 14, 92&15, 99, 48, 56, 23, 60, 31, 17, 43, 8, 90, 166, 100\\ 37,51,63&\quad, 94, 14, 92&15, 99, 48, 56, 23, 60, 31, 17, 43, 8, 90, 166, 100\\ 37,51,63&15, 94, 14, 92& 99, 48, 56, 23, 60, 31, 17, 43, 8, 90, 166, 100\\ 37,51,63,92&15, 94, 14, \quad& 99, 48, 56, 23, 60, 31, 17, 43, 8, 90, 166, 100\\ 37,51,63,92&15, 94, 14, 99& 48, 56, 23, 60, 31, 17, 43, 8, 90, 166, 100\\ 37,51,63,92,94&15, \quad, 14, 99& 48, 56, 23, 60, 31, 17, 43, 8, 90, 166, 100\\ 37,51,63,92,94&15, 48, 14, 99&56, 23, 60, 31, 17, 43, 8, 90, 166, 100\\ 37,51,63,92,94,99&15, 48, 14, \quad&56, 23, 60, 31, 17, 43, 8, 90, 166, 100\\ 37,51,63,92,94,99&15, 48, 14, 56&23, 60, 31, 17, 43, 8, 90, 166, 100\\ 37,51,63,92,94,99,*&15, 48, 14, 56&23, 60, 31, 17, 43, 8, 90, 166, 100\\ 37,51,63,92,94,99,*,14&15, 48, \quad, 56&23, 60, 31, 17, 43, 8, 90, 166, 100\\ 37,51,63,92,94,99,*,14&15, 48, 23, 56&60, 31, 17, 43, 8, 90, 166, 100\\ 37,51,63,92,94,99,*,14,15&\quad, 48, 23, 56&60, 31, 17, 43, 8, 90, 166, 100\\ 37,51,63,92,94,99,*,14,15&60, 48, 23, 56&31, 17, 43, 8, 90, 166, 100\\ 37,51,63,92,94,99,*,14,15,23,&60, 48, \quad, 56&31, 17, 43, 8, 90, 166, 100\\ 37,51,63,92,94,99,*,14,15,23,&60, 48, 31, 56&17, 43, 8, 90, 166, 100\\ 37,51,63,92,94,99,*,14,15,23,31&60, 48, \quad, 56&17, 43, 8, 90, 166, 100\\ 37,51,63,92,94,99,*,14,15,23,31&60, 48, 17, 56&43, 8, 90, 166, 100\\ 37,51,63,92,94,99,*,14,15,23,31,48&60, \quad, 17, 56&43, 8, 90, 166, 100\\ 37,51,63,92,94,99,*,14,15,23,31,48&60, 43, 17, 56&8, 90, 166, 100\\ 37,51,63,92,94,99,*,14,15,23,31,48,56&60, 43, 17, \quad&8, 90, 166, 100\\ 37,51,63,92,94,99,*,14,15,23,31,48,56&60, 43, 17, 8&90, 166, 100\\ 37,51,63,92,94,99,*,14,15,23,31,48,56,60&\quad, 43, 17, 8&90, 166, 100\\ 37,51,63,92,94,99,*,14,15,23,31,48,56,60&90, 43, 17, 8& 166, 100\\ 37,51,63,92,94,99,*,14,15,23,31,48,56,60,90&\quad, 43, 17, 8& 166, 100\\ 37,51,63,92,94,99,*,14,15,23,31,48,56,60,90&166, 43, 17, 8& 100\\ 37,51,63,92,94,99,*,14,15,23,31,48,56,60,90,166&\quad, 43, 17, 8& 100\\ 37,51,63,92,94,99,*,14,15,23,31,48,56,60,90,166&100, 43, 17, 8&\\ 37,51,63,92,94,99,*,14,15,23,31,48,56,60,90,166,*&100, 43, 17, 8&\\ 37,51,63,92,94,99,*,14,15,23,31,48,56,60,90,166,*,8&100, 43, 17, \quad&\\ 37,51,63,92,94,99,*,14,15,23,31,48,56,60,90,166,*,8,17&100, 43, \quad, \quad&\\ 37,51,63,92,94,99,*,14,15,23,31,48,56,60,90,166,*,8,17,43&100, \quad, \quad, \quad&\\ 37,51,63,92,94,99,*,14,15,23,31,48,56,60,90,166,*,8,17,43,100&\quad, \quad, \quad, \quad&\\ \end{array}$
> 
> 最后分成三个归并段：
> 
> - 37, 51, 63, 92, 94, 99
> - 14, 15, 23, 31, 48, 56, 60, 90, 166
> - 8, 17, 43, 100
> 
> ⑵ 对任意的 $m \,(n \gg m > 0)$ ，生成的第一个初始归并段的长度：
> 
> 设输入序列为 $x_1,x_2,\dots, x_n$ ，假设所有关键字互不相同。
> 
> 最大值为 $n$ ，刚开始进入 WA 的 $m$ 个关键字一定能够被输出，一般地，考虑 $x_{m+1},x_{m+2},\dots, x_n$ 均能够被输出到第一个归并段，则只要每次进入 WA 的关键字恰巧大于刚刚离开 WA 的关键字。也就是 $x_k$ ，这里 $k>m$ ，只要 $x_k$ 在序列 $x_1,x_2,\dots, x_k$ 中为第 $l$ 大的关键字，其中 $l\ge k-m+1$ ，则 $x_k$ 一定能被输出到第一个归并段。特殊地，假设输入序列为一个升序序列， 即$x_1<x_2<\dots<x_n$ ，则所有关键字一定都被输出到第一个归并段。
> 
> 最小值为 $m$ ，刚开始进入 WA 的 $m$ 个关键字一定能够被输出，一般地，考虑 $x_{m+1},x_{m+2},\dots, x_n$ 均不能被输出到第一个归并段，有 $\min\{x_1,x_2,\dots,x_m\}>\max\{x_{m+1},x_{m+2},\dots,x_{2m}\}$ ，也就是集合 $\{x_1,x_2,\dots,x_m\}$ 中所有关键字被输出后，停留在 WA 的集合 $\{x_{m+1},x_{m+2},\dots,x_{2m}\}$ 中所有关键字均无法被输出到第一个归并段。特殊地，假设输入序列为一个降序序列， 即$x_1>x_2>\dots>x_n$ ，则只有前 $m$ 个关键字能够被输出到第一个归并段。