---
publish: true
tags: 
aliases: 
finished: true
title: 题45
created: "2024-11-21 07:26"
updated: "2024-11-21 07:40"
---
## 题45
### 题目
> [!question]+
> （7 分）
> 
> 某文件系统的磁盘块大小为 4KB，目录项由文件名和索引节点号构成，每个索引节点占 256 字节，其中包含直接地址项 10 个，一级、二级和三级间接地址项各 1 个，每个地址项占 4 字节。该文件系统中子目录 stu 的结构如题 45(a) 图所示，stu 包含子目录 course 和文件 doc，course 子目录包含文件 course1 和 course2。各文件的文件名、索引节点号、占用磁盘块的块号如题 45(b) 图所示。
> 
> ![](https://pic4.zhimg.com/v2-868059876b9e2aa6d004d154f70a5ad1_r.jpg)
> 
> 文件名索引节点号磁盘块号$\begin{array}{|c|}\hline \text{文件名}&\text{索引节点号}&\text{磁盘块号}\\\hline \text{stu}&1&10\\ \text{course}&2&20\\ \text{course1}&10&30\\ \text{course2}&100&40\\ \text{doc}&10&x\\\hline \end{array}$
> 
> 题 45(b) 图
> 
> 请回答下列问题。
> 
> (1) 目录文件 stu 中每个目录项的内容是什么？
> 
> (2) 文件 doc 占用的磁盘块的块号 $x$ 的值是多少？
> 
> (3) 若目录文件 course 的内容已在内存，则打开文件 course1 并将其读入内存，需要读几个磁盘块？说明理由。
> 
> (4) 若文件 course2 的大小增长到 6MB，为了存取 course2 需要使用该文件索引节点的哪几级间接地址项？说明理由。
### 解
> [!done]+
> (1) 由题 45(a) 图可知，stu 目录下有 course 和 doc 两个文件，查题 45(b) 图中的表可知，course 的索引节点号为 2，doc 的索引节点号为 10。因为目录项由文件名和索引节点号构成，所以目录文件 stu 中两个目录项的内容是：
> 
> 文件名索引节点号$\begin{array}{|c|}\hline \text{文件名}&\text{索引节点号}\\\hline \text{course}&2\\ \text{doc}&10\\\hline \end{array}$
> 
> (2) 查题 45(b) 图中的表可知，文件 doc 和文件 course1 的索引节点号都是 10，说明两者共享同一个索引节点，指向同一个文件，所以两者的磁盘块号相同。文件 course1 占用的磁盘块的块号为 30，所以文件 doc 占用的磁盘块的块号 $x$ 的值为 30。
> 
> (3) 需要读 2 个磁盘块。先读 course1 的索引节点所在的磁盘块，再读 course1 的内容所在的磁盘块。若目录文件 course 的内容已在内存，course1 的目录项在文件 course 的目录中，根据 course1 的目录项可知其索引节点号为 10，首先读取 10 号索引节点所在的磁盘块，索引节点中包含文件的地址项，然后读取 30 号磁盘块的内容。
> 
> (4) 存取 course2 需要使用索引节点的一级和二级间接地址项。文件 course2 的大小增长到 6MB，磁盘块大小为 4KB，文件 course2 需占用 6MB/4KB=1536 个磁盘块。每个地址项占 4B，一个磁盘块可容纳 4KB/4B=1024 个地址项。每个索引节点包含直接地址项 10 个，一级、二级和三级间接地址项各 1 个。所以直接地址项可记录 10×1=10 个磁盘块，直接地址项和一级间接地址可记录 10×1+1×1024=1034，直接地址项、一级间接地址和二级间接地址可记录 10×1+1×1024+1× $1024^2$ =1049610。文件 course2 中的地指项位于 100 号索引节点，即对应一个索引节点，占用 1536 个磁盘块，1034<1536≤1049610。所以存取 course2 需要使用到索引节点的的间接地址项包括一级和二级间接地址项。