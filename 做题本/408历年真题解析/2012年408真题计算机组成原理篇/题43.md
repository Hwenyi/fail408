---
publish: true
tags: 
aliases: 
finished: true
title: 题43
created: "2024-11-21 06:42"
updated: "2024-11-21 07:40"
---
## 题43
### 题目
> [!question]+
> （10 分）
> 
> 假定某计算机的 CPU 主频为 80MHz，CPI 为 4，平均每条指令访存 1.5 次，主存与 Cache 之间交换的块大小为 16B，Cache 的命中率为 99%，存储器总线宽度为 32 位。请回答下列问题。
> 
> (1) 该计算机的 MIPS 数是多少？平均每秒 Cache 缺失的次数是多少？在不考虑 DMA 传送的情况下，主存带宽至少达到多少才能满足 CPU 的访存要求？
> 
> (2) 假定在 Cache 缺失的情况下访问主存时，存在 0.0005% 的缺页率，则 CPU 平均每秒产生多少次缺页异常？若页面大小为 4KB，每次缺页都需要访问磁盘，访问磁盘时 DMA 传送采用周期挪用方式，磁盘 I/O 接口的数据缓冲寄存器为 32 位，则磁盘 I/O 接口平均每秒发出的 DMA 请求次数至少是多少？
> 
> (3) CPU 和 DMA 控制器同时要求使用存储器总线时，哪个优先级更高？为什么？
> 
> (4) 为了提高性能，主存采用四体低位交叉存储模式，工作时每 1/4 个存储周期启动一个体。若每个体的存储周期为 50ns，则该主存能提供的最大带宽是多少？
### 解
> [!done]+
> (1) 第一问，因为 CPU 主频为 80MHz，CPI 为 4，所以平均每秒 CPU 执行的指令数为 80M/4=20M，即 MIPS 数是 20。
> 
> 第二问，因为平均每条指令访存 1.5 次，平均每秒 CPU 执行的指令数为 20M，Cache 的命中率为 99%，所以平均每秒 Cache 缺失次数为 20M×1.5×(1-99%)=0.3M。
> 
> 第三问，在 Cache 缺失的情况下，Cache 需要和主存进行块交换，因为主存与 Cache 之间交换的块大小为 16B，平均每秒交换 0.3M 次，所以为满足 CPU 的访存要求，主存带宽至少达到 16B×0.3M/s=4.8MB/s。
> 
> (2) 第一问，因为在 Cache 缺失的情况下访问主存时，存在 0.0005% 的缺页率，根据 (1) 结果，平均每秒 Cache 缺失次数为 0.3M，所以平均每秒产生的缺页中断次数为 0.3M×0.0005%=1.5。
> 
> 第二问，考察周期挪用方式，周期挪用是指利用 CPU 不访问存储器的那些周期来实现 DMA 操作，此时 DMA 可以使用总线而不用通知 CPU 也不会妨碍 CPU 的工作。在这种方法中，每当 I/O 设备发出 DMA 请求时，I/O 设备便挪用或窃取总线占用权一个或几个主存周期，而 DMA 不请求时，CPU 仍继续访问主存。
> 
> 因为存储器总线宽度为 32 位，所以每传送 32 位数据，磁盘控制器发出一次 DMA 请求，平均每秒产生的缺页中断次数为 1.5，页面大小为 4KB，所以每秒发出的 DMA 请求次数至少是 1.5×4KB/4B=1.5× $2^{10}$=1536。注意，当 K、M、G、T 修饰字节或比特时分别表示 $2^{10}$ 、 $2^{20}$ 、 $2^{30}$ 、 $2^{40}$ ，当 K、M、G、T 修饰字节或比特相关的速率时分别表示 $10^3$ 、 $10^6$ 、 $10^9$ 、 $10^{12}$ 。
> 
> (3) 第一问，CPU 和 DMA 控制器同时要求使用存储器总线时，DMA 优先级更高。
> 
> 第二问，因为如果 DMA 请求得不到及时响应，I/O 传输数据可能会丢失。
> 
> (4) 因为主存采用四体低位交叉存储模式，四体低位交叉存储为流水线四体并行。又因为存储器总线宽度为 32 位，工作时每 1/4 个存储周期启动一个体，则每个存储周期最多（四体并行时）可以传输 32bit/(1/4)=16B，又因为每个体的存储周期为 50ns，所以最大带宽是 16B/50ns=320MB/s。