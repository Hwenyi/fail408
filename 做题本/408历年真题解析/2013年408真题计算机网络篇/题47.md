---
publish: true
tags: 
aliases: 
finished: true
title: 题47
created: "2024-11-21 06:42"
updated: "2024-11-21 07:40"
---
## 题47
### 题目
> [!question]+
> （9 分）
> 
> 假设 Internet 的两个自治系统构成的网络如题 47 图所示，自治系统 AS1 由路由器 R1 连接两个子网构成；自治系统 AS2 由路由器 R2、R3 互联并连接 3 个子网构成。各子网地址、R2 的接口名、R1 与 R3 的部分接口 IP 地址如题 47 图所示。
> 
> ![](https://pic1.zhimg.com/v2-01a5a1b3231a92a46ca16d1ef28ac63e_r.jpg)
> 
> 请回答下列问题。
> 
> (1) 假设路由表结构如下表所示。
> 
> $\begin{array}{|c|}\hline 目的网络 &下一跳 &接口\\\hline \end{array}$
> 
> 请利用路由聚合技术，给出 R2 的路由表，要求包括到达题 47 图中所有子网的路由，且路由表中的路由项尽可能少。
> 
> (2) 若 R2 收到一个目的 IP 地址为 194.17.20.200 的 IP 分组，R2 会通过哪个接口转发该 IP 分组？
> 
> (3) R1 与 R2 之间利用哪个路由协议交换路由信息？该路由协议的报文被封装到哪个协议的分组中进行传输？
### 解
> [!done]+
> (1) 题目要求利用路由聚合技术，使得 R2 的路由表中的路由项尽可能少。可以根据 R2 的接口进行划分。
> 
> 153.14.5.0/25 和 153.14.5.128/25 都通过 R2 的 S0 接口连接 R2，可以将两者进行聚合。显然两者的前 24 位完全相同，将两者后 8 位写成二进制形式，其中主机号部分用的位用 x 表示，每个 x 可以取 0 或 1。二进制位用红色表示。153.14.5.0/25 为 $\rm153.14.5.\color{red}{0xxxxxxx}$ ，153.14.5.128/25 为 $\rm153.14.5.\color{red}{1xxxxxxx}$ ，两者前 24 位完全相同，聚合为 $\rm153.14.5.\color{red}{xxxxxxxx}$ ，即 153.14.5.0/24。
> 
> 194.17.20.128/25 通过 R2 的 E0 接口连接 R2，单独构成一个路由。
> 
> 194.17.20.0/25 和 194.17.21.0/24 都通过 R2 的 S0 接口连接 R2，可以将两者进行聚合。显然两者的前 16 位完全相同，将两者后 16 位写成二进制形式，其中主机号部分用的位用 x 表示，每个 x 可以取 0 或 1。二进制位用红色表示。194.17.20.0/25 为 $\rm194.17.\color{red}{00010100.0xxxxxxx}$ ，194.17.21.0/24 为 $\rm194.17.\color{red}{00010101.xxxxxxxx}$ ，两者前 23 位完全相同，聚合为 $\rm194.17.\color{red}{0001010x.xxxxxxxx}$ ，即 194.17.20.0/23。
> 
> 最终得到 R2 的路由表如下：
> 
> <table data-draft-node="block" data-draft-type="table" data-size="normal" data-row-style="normal"><tbody><tr><td>目的网络</td><td>下一跳</td><td>接口</td></tr><tr><td>153.14.5.0/24</td><td>153.14.3.2</td><td>S0</td></tr><tr><td>194.17.20.128/25</td><td>-</td><td>E0</td></tr><tr><td>194.17.20.0/23</td><td>194.17.24.2</td><td>S1</td></tr></tbody></table>
> 
> (2) 查路由表，目的 IP 地址为 194.17.20.200 的 IP 分组和目的网络 194.17.20.128/25 和 194.17.20.0/23 的前 3 个十进制数相同，即前 24 个比特位均相同，根据最长前缀匹配原则，194.17.20.200 会被转发到子网 194.17.20.128/25，R2 会通过接口 E0 转发该 IP 分组。
> 
> (3) 由于 R1 和 R2 分属自治系统 AS1 和 自治系统 AS2，需要使用外部网关协议 (Exterior Gateway Protocol, EGP) 交换路由信息，由于 EGP 存在很多的局限性，IETF 边界网关协议工作组制定了标准的边界网关协议 (Border Gateway Protocol, BGP)，当前被广泛使用，目前已经升级到 4.0 版本，即 BGP4，BGP4 是最广泛使用的 BGP 版本，也是当前的域间路由标准。R1 与 R2 之间利用 BGP4（或 BGP）交换路由信息；BGP4 的报文被封装到 TCP 协议段中进行传输。