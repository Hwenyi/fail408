---
publish: true
tags: 
aliases: 
finished: true
title: 题44
created: "2024-11-21 07:27"
updated: "2024-11-21 07:40"
---
## 题44
### 题目
> [!question]+
> （8 分）
> 
> 假设某磁盘驱动器中有 4 个双面盘片，每个盘面有 20000 个磁道，每个磁道有 500 个扇区，每个扇区可记录 512 字节的数据，盘片转速为 7200rpm（转 / 分），平均寻道时间为 5ms，请回答下列问题。
> 
> (1) 每个扇区包含数据及地址信息，地址信息分为 3 个字段，这 3 个字段的名称格式什么？对于该磁盘，各字段至少占多少位？
> 
> (2) 一个扇区的平均访问时间约为多少？
> 
> (3) 若采用周期挪用 DMA 方式进行磁盘与主机之间的数据传送，磁盘控制器中的数据缓冲区大小为 64 位，则在一个扇区读写过程中，DMA 控制器向 CPU 发送了多少次总线请求？若 CPU 检测到 DMA 控制器的总线请求信号时也需要访问主存，则 DMA 控制器是否可以获得总线使用权？为什么？
### 解
> [!done]+
> (1) 磁盘地址格式为 $\begin{array}{|c|c|c|c|c|c|}\hline \text{驱动器号}&\text{柱面号}&\text{盘面号}&\text{扇区号}\\\hline \end{array}$ ，本题中只有一个磁盘驱动器，不需要考虑驱动器号。每个扇区的地址信息分为 3 个字段，分别为柱面号（磁道号）、盘面号（磁头号）、扇区号。每个盘面有 20000 个磁道，该磁盘共有 20000 个柱面，柱面号字段至少占 $\lceil \log 20000\rceil=15$ 位。该磁盘有 4 个双面盘片，共计 4×2=8 个盘面，盘面号字段至少占 $\lceil \log 8\rceil=3$ 位。每个磁道有 500 个扇区，扇区号至少占 $\lceil \log 500\rceil=9$ 位。
> 
> (2) 一个扇区的平均访问时间 = 平均寻道时间 + 平均延迟时间 + 传输时间。
> 
> 平均寻道时间 = 5ms。
> 
> 平均延迟时间（盘片转半圈时间） = $\rm \frac{1r}{2\times7200rp}= \frac{1r}{2\times120rps} = \frac{1}{240}s \approx 4.167ms$ 。
> 
> 传输时间（盘片转一个扇区时间） = $\rm\frac{ 1r}{500×7200rpm} =\frac{ 1r}{500×120rps} ≈ 0.017ms$ 。
> 
> 所以一个扇区的平均访问时间约为 5ms + 4.167ms + 0.017ms = 9.183ms。
> 
> (3) 第一问。磁盘控制器中的数据缓冲区每充满一次，DMA 控制器就需要发出一次总线请求，磁盘控制器中的数据缓冲区大小为 64 位，每个扇区可记录 512 字节的数据，则在一个扇区读写过程中，DMA 控制器向 CPU 发送了 512B/64bit=64 次总线请求。
> 
> 第二问。由于采用周期挪用 DMA 方式，因此若 CPU 检测到 DMA 控制器的总线请求信号时也需要访问主存，则 DMA 请求的优先级更高，DMA 控制器是可以获得总线使用权。
> 
> 第三问。若无法按时完成数据传输，后来磁盘控制器中的数据缓冲区的数据可能会覆盖其先前还未传输的数据，造成数据丢失。